!function(e){var t=e("ul#wpuf-form-editor"),i={init:function(){this.makeSortable(),this.tooltip(),this.tabber(),this.showHideHelp(),e("#wpuf-metabox-settings").on("change",'select[name="wpuf_settings[redirect_to]"]',this.settingsRedirect),e("#wpuf-metabox-settings-update").on("change",'select[name="wpuf_settings[edit_redirect_to]"]',this.settingsRedirect),e('select[name="wpuf_settings[redirect_to]"]').change(),e('select[name="wpuf_settings[edit_redirect_to]"]').change(),e("#wpuf-metabox-settings").on("change",'input[type=checkbox][name="wpuf_settings[guest_post]"]',this.settingsGuest),e('input[type=checkbox][name="wpuf_settings[guest_post]"]').trigger("change"),e("#wpuf-metabox-settings").on("change",'input[type=checkbox][name="wpuf_settings[guest_details]"]',this.settingsGuestDetails),e("button.wpuf-collapse").on("click",this.collpaseEditFields),e(".wpuf-form-buttons").on("click","button",this.addNewField),e("#wpuf-form-editor").on("click",".wpuf-remove",this.removeFormField),e("#wpuf-form-editor").on("change",'li.custom-field input[data-type="label"]',this.setMetaKey),e("#wpuf-form-editor").on("change",".wpuf-form-sub-fields input[type=text]",function(){var t=e(this),i=t.closest("div").find("input[data-type=option_value]").val();if(""===i){var s=t.closest("div").find("input[data-type=option]").val();t.siblings("input[type=checkbox], input[type=radio]").val(s)}else t.siblings("input[type=checkbox], input[type=radio]").val(i)}),e("#wpuf-form-editor").on("click","input[type=checkbox].multicolumn",function(){var t=e(this),i=t.closest(".wpuf-form-rows");t.is(":checked")?(i.next().hide().next().hide(),i.siblings(".column-names").show()):(i.next().show().next().show(),i.siblings(".column-names").hide())}),e("#wpuf-form-editor").on("click","input[type=checkbox].retype-pass",function(){var t=e(this),i=t.closest(".wpuf-form-rows");t.is(":checked")?i.next().show().next().show():i.next().hide().next().hide()}),e("#wpuf-form-editor").on("click","input[type=checkbox].woo_attr",function(){var t=e(this),i=t.closest(".wpuf-form-rows");t.is(":checked")?i.next().show():i.next().hide()}),e("#wpuf-form-editor").on("click",".wpuf-toggle",this.toggleFormField),e("#wpuf-form-editor").on("click","img.wpuf-clone-field",this.cloneField),e("#wpuf-form-editor").on("click","img.wpuf-remove-field",this.removeField),e("#wpuf-form-editor").on("click",".wpuf-value-handelar",this.showValueField)},showValueField:function(){var t=e(this),i=t.closest("div").find("input[data-type=option_value], span.wpuf-option-value");t.is(":checked")?i.show():i.hide()},showHideHelp:function(){var t=e("ul#wpuf-form-editor").children("li");t.length?e(".wpuf-updated").hide():e(".wpuf-updated").show()},makeSortable:function(){t=e("ul#wpuf-form-editor"),t&&t.sortable({placeholder:"ui-state-highlight",handle:"> .wpuf-legend",distance:5})},addNewField:function(t){t.preventDefault();var s=e(this),n=e("ul#wpuf-form-editor"),o=s.data("name"),a=s.data("type"),r={name:o,type:a,order:n.find("li").length+1,action:"wpuf_form_add_el"},l=["post_title","post_content","post_excerpt","featured_image","user_login","first_name","last_name","nickname","user_email","user_url","user_bio","password","user_avatar"];return e.inArray(o,l)>=0&&n.find("li."+o).length?(alert("You already have this field in the form"),!1):(e(".wpuf-loading").removeClass("hide"),void e.post(ajaxurl,r,function(t){n.append(t),i.makeSortable(),i.tooltip(),e(".wpuf-loading").addClass("hide"),i.showHideHelp()}))},removeFormField:function(t){t.preventDefault(),confirm("are you sure?")&&e(this).closest("li").fadeOut(function(){e(this).remove(),i.showHideHelp()})},toggleFormField:function(t){t.preventDefault(),e(this).closest("li").find(".wpuf-form-holder").slideToggle("fast")},cloneField:function(t){t.preventDefault();var i=e(this).closest("div"),s=i.clone();s.find("input").val(""),s.find(":checked").attr("checked",""),i.after(s)},removeField:function(){var t=e(this).closest("div"),i=t.siblings(".wpuf-clone-field").andSelf().length;i>1&&t.remove()},setMetaKey:function(){var t=e(this),i=t.val().toLowerCase().split(" ").join("_").split("'").join(""),s=e(this).closest(".wpuf-form-rows").next().find("input[type=text]");i=i.replace(/[^a-z0-9]|\s+|\r?\n|\r/gim,"_"),s.length&&s.val(i)},tooltip:function(){e(".smallipopInput").smallipop({preferredPosition:"right",theme:"black",popupOffset:0,triggerOnClick:!0})},collpaseEditFields:function(t){t.preventDefault(),e("ul#wpuf-form-editor").children("li").find(".wpuf-form-holder").slideToggle()},settingsGuest:function(t){t.preventDefault();var i=e(this).closest("table");e(this).is(":checked")?(i.find("tr.show-if-guest").show(),i.find("tr.show-if-not-guest").hide(),e('input[type=checkbox][name="wpuf_settings[guest_details]"]').trigger("change")):(i.find("tr.show-if-guest").hide(),i.find("tr.show-if-not-guest").show())},settingsGuestDetails:function(t){t.preventDefault();var i=e(this).closest("table");e(this).is(":checked")?i.find("tr.show-if-details").show():i.find("tr.show-if-details").hide()},settingsRedirect:function(t){t.preventDefault();var i=e(this),s=i.closest("table"),n=i.val();switch(n){case"post":s.find("tr.wpuf-page-id, tr.wpuf-url, tr.wpuf-same-page").hide();break;case"page":s.find("tr.wpuf-page-id").show(),s.find("tr.wpuf-same-page").hide(),s.find("tr.wpuf-url").hide();break;case"url":s.find("tr.wpuf-page-id").hide(),s.find("tr.wpuf-same-page").hide(),s.find("tr.wpuf-url").show();break;case"same":s.find("tr.wpuf-page-id").hide(),s.find("tr.wpuf-url").hide(),s.find("tr.wpuf-same-page").show()}},tabber:function(){e(".group").hide(),e(".group:first").fadeIn(),e(".group .collapsed").each(function(){e(this).find("input:checked").parent().parent().parent().nextAll().each(function(){return e(this).hasClass("last")?(e(this).removeClass("hidden"),!1):void e(this).filter(".hidden").removeClass("hidden")})}),e(".nav-tab-wrapper a:first").addClass("nav-tab-active"),e(".nav-tab-wrapper a").click(function(t){e(".nav-tab-wrapper a").removeClass("nav-tab-active"),e(this).addClass("nav-tab-active").blur();var i=e(this).attr("href");e(".group").hide(),e(i).fadeIn(),t.preventDefault()})}};e(function(){i.init()})}(jQuery);